<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Кейс‑казино • Telegram версия</title>
  <!--
    Этот документ представляет собой переработанную версию оригинального «Кейс‑казино»,
    приспособленную для использования как обычного сайта, так и мини‑приложения
    Telegram. Основные изменения включают поддержку безопасных отступов для
    полноэкранного режима, использование CSS‑переменных для динамического
    применения темы Telegram, более гибкие размеры и улучшенную доступность.

    Чтобы изменить тему, скрипт внизу страницы считывает параметры Telegram
    (bg_color, text_color, button_color и др.) и применяет их к переменным,
    определённым в :root. Если приложение запущено вне Telegram, используются
    стандартные значения.

    Согласно рекомендациям Telegram Mini Apps, все элементы имеют мобильную
    ориентацию и соблюдают безопасную зону экрана【365779233254398†L342-L354】.
  -->
  <!-- Подключаем скрипт Telegram Web Apps SDK. Он не помешает, если страница
       открыта как обычный сайт: наличие объекта Telegram проверяется в коде -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      /* Базовые цвета. Они будут переопределены скриптом, если доступна тема Telegram */
      --bg-color: #0a1a0a;
      --text-color: #ffffff;
      --card-bg: rgba(0, 0, 0, 0.6);
      --btn-gradient-start: #ffea70;
      --btn-gradient-end: #d4af37;
      --btn-text-color: #0e0e0e;
    }

    /* Сброс отступов и базовая типографика */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      min-height: 100vh;
      /* Поддержка безопасных зон для устройств с вырезами (iPhone) */
      padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
      overflow-y: auto;
      touch-action: manipulation;
    }

    /* Общие стили для всех страниц */
    .page {
      position: absolute;
      inset: 0;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 16px;
      gap: 1rem;
      background-size: cover;
      background-position: center;
      overflow-y: auto;
    }

    /* Заголовки и подзаголовки */
    h1 {
      font-size: clamp(1.7rem, 6.5vw, 2.4rem);
      text-align: center;
      line-height: 1.2;
      text-shadow: 0 3px 12px #000;
      margin-top: 0.5rem;
    }

    .subtitle {
      font-size: clamp(1rem, 4vw, 1.2rem);
      text-align: center;
      line-height: 1.35;
      max-width: 96%;
      opacity: 0.92;
      margin-bottom: 0.5rem;
    }

    /* Кнопки */
    .btn {
      padding: 14px 32px;
      font-size: clamp(1.05rem, 4.2vw, 1.15rem);
      font-weight: 600;
      background-image: linear-gradient(145deg, var(--btn-gradient-start), var(--btn-gradient-end));
      color: var(--btn-text-color);
      border: none;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.55);
      cursor: pointer;
      transition: transform 0.16s ease, box-shadow 0.16s ease;
      min-width: 150px;
    }

    .btn:active {
      transform: scale(0.97);
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.5);
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 14px 20px;
      width: 100%;
      margin-top: auto;
      padding-bottom: 12px;
    }

    /* Звёздный фон для генераторов */
    .stars {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }

    .star {
      position: absolute;
      background: #fff;
      border-radius: 50%;
      opacity: 0.3;
      animation: twinkle 5s infinite ease-in-out;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.2; transform: scale(0.9); }
      50%      { opacity: 0.65; transform: scale(1.15); }
    }

    /* Главная страница */
    #home {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 2vh;
      background-image: url('home_bg.webp');
      text-align: center;
    }

    #home img.hand {
      width: clamp(200px, 48vw, 280px);
      animation: handAppear 2.2s ease-out;
      margin-bottom: 16px;
    }

    @keyframes handAppear {
      0%   { opacity: 0; transform: translateY(60%) rotate(-8deg) scale(0.85); }
      70%  { opacity: 1; transform: translateY(0) rotate(4deg) scale(1.05); }
      100% { transform: translateY(0) rotate(0deg) scale(1); }
    }

    #home .cards {
      display: flex;
      gap: 24px;
      margin: 12px 0;
    }

    #home .card {
      width: clamp(100px, 32vw, 150px);
      cursor: pointer;
      transition: transform 0.25s ease;
    }

    #home .card:active {
      transform: scale(1.14);
    }

    /* Страница загрузки */
    #loading {
      background-image: url('scene_bg.webp');
      justify-content: flex-start;
      align-items: center;
      padding-top: 6vh;
    }

    #loading .dealer {
      width: clamp(220px, 55vw, 340px);
      max-height: 52vh;
      object-fit: contain;
      margin: 12px 0 20px;
    }

    #loading .dialog {
      text-align: center;
      margin-top: auto;
      padding-bottom: 10px;
      max-width: 90%;
    }

    /* Страницы генераторов */
    #design,
    #marketing {
      justify-content: flex-start;
      align-items: center;
      padding-top: 5vh;
      gap: 1.2vh;
    }

    #design { background-image: url('design_bg.webp'); }
    #marketing { background-image: url('marketing_bg.webp'); }

    .gen-img {
      width: clamp(160px, 42vw, 220px);
      margin: 12px 0 16px;
      cursor: pointer;
    }

    /* Контейнер для сгенерированного ТЗ */
    .tz-box {
      background: var(--card-bg);
      backdrop-filter: blur(8px);
      border-radius: 10px;
      padding: 12px 14px;
      width: 92%;
      max-width: 500px;
      font-size: clamp(0.92rem, 3.5vw, 1.1rem);
      line-height: 1.4;
      word-wrap: break-word;
    }

    /* Чекбоксы в дизайнерском генераторе */
    .checkboxes {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px 16px;
      margin: 12px 0;
      font-size: clamp(0.9rem, 3.6vw, 1rem);
    }

    .checkboxes label {
      background: rgba(255, 255, 255, 0.07);
      padding: 8px 14px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .checkboxes input[type="checkbox"] {
      accent-color: var(--btn-gradient-end);
    }

    .checkboxes input[type="text"] {
      background: rgba(255, 255, 255, 0.07);
      border: none;
      border-radius: 8px;
      padding: 8px 14px;
      color: var(--text-color);
      outline: none;
      width: 140px;
    }

    select {
      padding: 10px 16px;
      font-size: 1rem;
      background: rgba(30, 30, 30, 0.75);
      color: var(--text-color);
      border: 1px solid #444;
      border-radius: 8px;
      margin: 10px 0;
      width: 90%;
      max-width: 360px;
    }

    /* Адаптация для планшетов и десктопов */
    @media (min-width: 768px) {
      h1 { font-size: 2.6rem; }
      .gen-img { width: 240px; }
      .btn { padding: 14px 40px; font-size: 1.2rem; }
    }
  </style>
</head>
<body>
  <!-- Главная -->
  <div id="home" class="page">
    <img src="home_hand.png" class="hand" alt="Ладонь, приглашающая выбрать карту" />
    <div class="cards">
      <img src="card_design.png" class="card" onclick="selectRole('design')" alt="Карта дизайнера" />
      <img src="card_marketing.png" class="card" onclick="selectRole('marketing')" alt="Карта маркетолога" />
    </div>
    <p>Выберите карту</p>
  </div>

  <!-- Страница загрузки -->
  <div id="loading" class="page">
    <img src="scene_dealer.webp" class="dealer" alt="Дилер приглашает" />
    <div class="dialog">
      <p>У меня есть пара интересных кейсов для тебя</p>
      <div class="buttons btn-row">
        <button class="btn" onclick="goToGenerator()">Хорошо, идём</button>
        <button class="btn" onclick="goHome()">Я не определился с картой</button>
      </div>
    </div>
  </div>

  <!-- Генератор для дизайнеров -->
  <div id="design" class="page">
    <div class="stars"></div>
    <h1>Генератор кейсов для дизайнеров</h1>
    <p class="subtitle">Сгенерируйте идею для кейса: лого, презентация, мерч или брендбук</p>
    <img src="design_slot.png" class="gen-img" onclick="generateDesign()" alt="Слот‑машина с дизайном" />
    <div id="design-tz" class="tz-box"></div>
    <div class="checkboxes">
      <label><input type="checkbox" value="логотип" /> Логотип</label>
      <label><input type="checkbox" value="мерч" /> Мерч</label>
      <label><input type="checkbox" value="брендбук" /> Брендбук</label>
      <label><input type="checkbox" value="презентация" /> Презентация</label>
      <label><input type="checkbox" value="маскот" /> Маскот</label>
      <label><input type="text" id="custom-design" placeholder="Своё" /></label>
    </div>
    <div class="btn-row">
      <button class="btn" onclick="copyDesignTZ()">Скопировать ТЗ</button>
      <button class="btn" onclick="clearTZ('design')">Стереть</button>
      <button class="btn" onclick="goHome()">Домой</button>
    </div>
  </div>

  <!-- Генератор для маркетологов -->
  <div id="marketing" class="page">
    <div class="stars"></div>
    <h1>Генератор кейсов для маркетологов</h1>
    <p class="subtitle">Сгенерируйте идею для кейса: презентация, исследование, брендбук, сравнение и др.</p>
    <img src="marketing_dice.png" class="gen-img" onclick="generateMarketing()" alt="Кубики для генерации" />
    <div id="marketing-tz" class="tz-box"></div>
    <select id="marketing-type">
      <option value="презентация">Презентация</option>
      <option value="исследование">Исследование</option>
      <option value="брендбук">Брендбук</option>
      <option value="сравнение">Сравнение</option>
      <option value="другое">Другое</option>
    </select>
    <div class="btn-row">
      <button class="btn" onclick="copyMarketingTZ()">Скопировать ТЗ</button>
      <button class="btn" onclick="clearTZ('marketing')">Стереть</button>
      <button class="btn" onclick="goHome()">Домой</button>
    </div>
  </div>

  <script>
    // Массивы с названием компании, позиционированием, продуктами, проблемами, задачами, целями и цветами.
    // Используем полноразмерные списки, чтобы получить разнообразные кейсы.
    const companyNames = [
      "EcoBloom Solutions", "TechNova Innovations", "FreshHarvest Foods", "UrbanMobility Rides", "StyleForge Apparel",
      "HealthVibe Wellness", "CodeCraft Software", "GreenLeaf Energy", "LuxeHome Interiors", "FitTrack Gear",
      "ByteBridge Networks", "PureSip Beverages", "AdventureQuest Travel", "SmartNest Homes", "GlowBeauty Cosmetics",
      "PowerUp Fitness", "DataSphere Analytics", "CraftBrew Masters", "EcoDrive Autos", "MindfulMed Health",
      "VirtualWorld VR", "PetPals Supplies", "FinSecure Banking", "ArtisanalBake Goods", "SolarSpark Energy",
      "EduQuest Learning", "FashionFusion Clothes", "AgriTech Farms", "SoundWave Audio", "BioVital Supplements",
      "TravelTrek Tours", "HomeHarmony Decor", "SpeedNet Internet", "WellnessWave Spa", "InnovateHub Tech",
      "GourmetGrove Foods", "AutoElite Cars", "BrainBoost Education", "StyleSphere Fashion", "EcoPure Water",
      "GameForge Studios", "HealthHub Clinics", "CloudCore Computing", "BrewBuddy Coffee", "RideShare Mobility",
      "BeautyBloom Skincare", "EnergyEdge Power", "SoftServe IT", "FarmFresh Produce", "LuxTravel Experiences"
    ];

    const positionings = [
      "Экологически чистые решения для устойчивого будущего", "Инновационные технологии для цифровой трансформации",
      "Свежие органические продукты прямо с фермы", "Удобный и доступный городской транспорт",
      "Современная мода для уверенных в себе людей", "Holistic подход к здоровью и благополучию",
      "Надежное ПО для бизнеса любого масштаба", "Возобновляемая энергия для зеленого мира",
      "Элегантный дизайн интерьеров для комфорта", "Спортивное оборудование для активного образа жизни",
      "Безопасные сети для бесперебойной связи", "Натуральные напитки для ежедневного удовольствия",
      "Приключенческие туры для искателей адреналина", "Умные дома для современной жизни",
      "Натуральная косметика для сияющей кожи", "Фитнес‑программы для максимальной эффективности",
      "Аналитика данных для умных решений", "Ремесленное пиво для ценителей вкуса",
      "Экологичные автомобили для сознательных водителей", "Ментальное здоровье через mindfulness практики",
      "Иммерсивный VR для развлечений и образования", "Качественные товары для любимых питомцев",
      "Безопасные финансовые услуги для всех", "Ручная выпечка с традиционными рецептами",
      "Солнечная энергия для независимости", "Интерактивное обучение для детей и взрослых",
      "Фьюжн стилей в одежде для креативных", "Технологии для эффективного земледелия",
      "Аудиооборудование для профессионалов", "Биодобавки для естественного благополучия",
      "Персонализированные путешествия по миру", "Гармоничный декор для уютного дома",
      "Быстрый интернет для работы и развлечений", "Расслабляющие спа‑процедуры для релакса",
      "Хаб для инноваций в технологиях", "Гурманские продукты для изысканного вкуса",
      "Элитные автомобили для премиум‑класса", "Развитие мозга через образовательные инструменты",
      "Сфера стиля для модных трендов", "Чистая вода для здоровья семьи",
      "Игровые студии для эпичных приключений", "Клиники для комплексного ухода за здоровьем",
      "Облачные решения для бизнеса", "Кофе для бодрого старта дня", "Общий транспорт для экологичного перемещения",
      "Уход за кожей с натуральными ингредиентами", "Энергия на краю инноваций", "IT‑услуги для мягкой интеграции",
      "Свежие продукты с фермы к столу", "Роскошные путешествия для незабываемых впечатлений"
    ];

    const products = [
      "Органические удобрения", "AI‑платформа для автоматизации", "Свежие овощи и фрукты", "Электрические скутеры",
      "Линейка уличной одежды", "Йога‑маты и аксессуары", "CRM‑система", "Солнечные панели",
      "Мебель для гостиной", "Фитнес‑трекеры", "VPN‑сервисы", "Энергетические напитки",
      "Туристические пакеты", "Умные термостаты", "Кремы для лица", "Протеиновые шейкеры",
      "BI‑инструменты", "Крафтовое пиво", "Электрокары", "Медитационные приложения", "VR‑очки",
      "Корм для собак", "Мобильный банкинг app", "Хлеб и пирожные", "Инверторы для солнечных систем",
      "Онлайн‑курсы", "Аксессуары для одежды", "Дроны для ферм", "Наушники", "Витаминные комплексы",
      "Экскурсионные туры", "Подушки и покрывала", "Роутеры", "Маски для лица", "Гаджеты для стартапов",
      "Сыры и деликатесы", "Спортивные машины", "Пазлы для мозга", "Сумки и рюкзаки", "Фильтры для воды",
      "Видеоигры", "Диагностическое оборудование", "Серверы", "Кофейные зерна", "Велосипеды‑шеринг",
      "Сыворотки для кожи", "Батареи для хранения энергии", "SaaS‑платформы", "Молочные продукты",
      "Отельные пакеты"
    ];

    const designProblems = [
      "Устаревший логотип не отражает современный бренд", "Несоответствие цветовой палитры в UI/UX",
      "Плохая читаемость шрифтов на мобильных устройствах", "Отсутствие responsive дизайна для разных экранов",
      "Скучный визуальный стиль упаковки продуктов", "Несогласованность иконок в приложении",
      "Низкое качество изображений на сайте", "Перегруженный интерфейс с лишними элементами",
      "Отсутствие анимаций для вовлечения пользователей", "Проблемы с доступностью для людей с нарушениями зрения",
      "Устаревший дизайн email‑рассылок", "Несовместимость брендбука с новыми продуктами",
      "Слабый визуальный storytelling в презентациях", "Плохая композиция landing page",
      "Отсутствие уникального маскота для бренда", "Конфликт стилей в соцсетях постах",
      "Низкая контрастность текстов и фона", "Устаревшие иллюстрации в мерче",
      "Проблемы с навигацией в веб‑приложении", "Отсутствие единого grid system в дизайне",
      "Слабый фокус на ключевых элементах CTA", "Несовременный дизайн визиток",
      "Плохая интеграция видео в интерфейс", "Отсутствие 3D‑элементов для продуктов",
      "Конфликты в типографике бренда", "Устаревший дизайн баннеров",
      "Низкое разрешение графики для печати", "Проблемы с white space в layouts",
      "Отсутствие motion design в промо", "Несогласованность цветов в палитре",
      "Слабый дизайн инфографики", "Плохая визуализация данных в дашбордах",
      "Устаревший стиль икон‑сета", "Отсутствие AR‑элементов для продуктов",
      "Конфликты в бренд‑гидлайнах", "Низкая привлекательность обложек",
      "Проблемы с scaling векторной графики", "Отсутствие immersive дизайна для VR",
      "Слабый редизайн старых ассетов", "Несовместимость с dark mode",
      "Плохая анимация переходов", "Отсутствие custom шрифтов",
      "Конфликты в цветовой доступности", "Устаревший дизайн флаеров",
      "Низкое качество рендеров продуктов", "Проблемы с alignment в grids",
      "Отсутствие interactive элементов", "Слабый дизайн error pages",
      "Несогласованность в UI kits", "Плохая визуальная иерархия"
    ];

    const marketingProblems = [
      "Низкий трафик на сайт из поисковиков", "Слабая конверсия в email‑кампаниях",
      "Отток аудитории в соцсетях", "Высокий bounce rate на landing pages", "Низкий ROI от рекламы",
      "Проблемы с сегментацией аудитории", "Слабый engagement в контент‑маркетинге",
      "Конкуренция в PPC‑рекламе", "Низкие продажи в offseason", "Проблемы с лояльностью клиентов",
      "Слабый охват в influencer‑маркетинге", "Высокий churn rate подписчиков",
      "Низкая видимость в поисковых системах", "Проблемы с A/B‑тестированием",
      "Слабый user‑generated content", "Конкуренция на рынке affiliate",
      "Низкий CTR в ads", "Проблемы с персонализацией предложений",
      "Слабый viral эффект кампаний", "Высокие затраты на acquisition",
      "Низкий lifetime value клиентов", "Проблемы с ретаргетингом",
      "Слабый PR в СМИ", "Конкуренция в content SEO",
      "Низкие конверсии из соцсетей", "Проблемы с email deliverability",
      "Слабый бренд‑awareness", "Высокий cart abandonment",
      "Низкий engagement в webinars", "Проблемы с партнерствами",
      "Слабый lead generation", "Конкуренция в programmatic ads",
      "Низкие отзывы от клиентов", "Проблемы с маркетинг‑автоматизацией",
      "Слабый охват в мобильном маркетинге", "Высокие затраты на content creation",
      "Низкий NPS score", "Проблемы с cross‑selling", "Слабый event‑маркетинг",
      "Конкуренция в видео‑рекламе", "Низкие подписки на newsletter",
      "Проблемы с data privacy в таргетинге", "Слабый B2B lead nurturing",
      "Высокий cost per click", "Низкий share of voice",
      "Проблемы с сезонным маркетингом", "Слабый omnichannel подход",
      "Конкуренция в e‑commerce", "Низкие метрики в app installs",
      "Проблемы с crisis management в маркетинге"
    ];

    const tasks = [
      "Разработать кампанию по повышению бренд‑осведомленности", "Проанализировать конкурентов и предложить дифференциацию",
      "Создать сезонную промо‑стратегию", "Оптимизировать цепочку поставок для маркетинга",
      "Переработать визуальную идентичность бренда", "Улучшить программу лояльности клиентов",
      "Интегрировать маркетинг с IT‑системами", "Продвигать зелёные инициативы",
      "Создать контент для соцсетей по интерьерам", "Маркетинг безопасного фитнеса",
      "Кампания по кибербезопасности", "Разработать аллерго‑дружественный маркетинг",
      "Адаптировать туры под новые регуляции", "Продвигать энергоэффективность",
      "Кампания по уходу за кожей", "Мотивирующий контент для фитнеса",
      "Очистка и анализ данных для маркетинга", "Брендинг ремесленного пива",
      "Эко‑маркетинг для авто", "Продвижение mindfulness", "Маркетинг VR для образования",
      "Кампании для владельцев питомцев", "Антифрод‑маркетинг в банкинге",
      "Маркетинг свежей выпечки", "Продвижение солнечной энергии",
      "Retention‑стратегии для курсов", "Трендовый маркетинг моды",
      "Агро‑маркетинг технологий", "Аудио‑брендинг", "Маркетинг здоровых добавок",
      "Безопасный туристический маркетинг", "Аллерго‑безопасный декор‑маркетинг",
      "Продвижение быстрого интернета", "Пост‑спа маркетинг", "Фандрайзинг для инноваций",
      "Маркетинг натуральных продуктов", "Безопасный авто‑маркетинг",
      "Маркетинг образовательных инструментов", "Устойчивый фэшн‑маркетинг",
      "Кампании по чистой воде", "Гейм‑маркетинг", "Доступный мед‑маркетинг",
      "Облачный B2B‑маркетинг", "Кофейный брендинг", "Анти‑трафик кампании",
      "Уход за кожей маркетинг", "Энерго‑хранение продвижение", "SaaS‑маркетинг",
      "Свежий продакт‑маркетинг", "Персонализированный тревел‑маркетинг"
    ];

    const goals = [
      "Увеличить долю рынка на 15%", "Достичь 1 млн пользователей", "Повысить продажи в offseason на 20%",
      "Сократить затраты на логистику на 10%", "Обновить бренд‑идентичность", "Увеличить retention до 70%",
      "Интегрировать все системы", "Стать лидером в зеленой энергии", "Расширить онлайн‑присутствие",
      "Минимизировать травмы через образование", "Обеспечить 99.9% uptime", "Расширить линейку hypoallergenic продуктов",
      "Адаптироваться к глобальным изменениям", "Снизить энергопотребление на 30%", "Достичь 5 млн продаж косметики",
      "Увеличить engagement в фитнесе", "Улучшить точность данных на 25%", "Завоевать 10% рынка craft beer",
      "Снизить эмиссии на 50%", "Достичь 100k подписчиков на app", "Сделать VR mainstream",
      "Стать топ‑брендом для pets", "Нулевой tolerance к фроду", "Увеличить shelf life",
      "Покрыть 20% рынка солнечных", "Снизить dropout до 10%", "Лидерство в fast fashion",
      "Увеличить урожайность на 15%", "Достичь Hi‑Fi стандартов", "Расширить дистрибуцию добавок",
      "Обеспечить безопасность туров", "Сделать декор аллерго‑free", "Покрыть 90% регионов",
      "Увеличить повторные визиты на 40%", "Привлечь 5 млн инвестиций", "Стать органик‑лидером",
      "Снизить аварии на 20%", "Улучшить концентрацию учеников", "Достичь устойчивости в производстве",
      "Очистить 1 млн литров воды", "Выпустить хит‑игру", "Расширить сеть клиник",
      "Масштабировать до enterprise", "Достичь 1 тонны продаж кофе", "Снизить трафик на 15%",
      "Лидер в skincare", "Хранить 100% энергии", "100k SaaS‑подписчиков",
      "Обеспечить свежесть на 100%", "Персонализировать 80% туров"
    ];

    const colors = [
      "Green / #008000", "Blue / #0000FF", "Red / #FF0000", "Yellow / #FFFF00", "Purple / #800080",
      "Orange / #FFA500", "Pink / #FFC0CB", "Teal / #008080", "Indigo / #4B0082", "Lime / #00FF00",
      "Cyan / #00FFFF", "Magenta / #FF00FF", "Brown / #A52A2A", "Gray / #808080", "Navy / #000080",
      "Olive / #808000", "Maroon / #800000", "Turquoise / #40E0D0", "Violet / #EE82EE", "Gold / #FFD700",
      "Silver / #C0C0C0", "Beige / #F5F5DC", "Coral / #FF7F50", "Lavender / #E6E6FA", "Mint / #98FB98",
      "Salmon / #FA8072", "Khaki / #F0E68C", "Plum / #DDA0DD", "Azure / #F0FFFF", "Crimson / #DC143C",
      "Fuchsia / #FF00FF", "Chartreuse / #7FFF00", "Orchid / #DA70D6", "Sienna / #A0522D",
      "Thistle / #D8BFD8", "Tomato / #FF6347", "Wheat / #F5DEB3", "Aquamarine / #7FFFD4",
      "Bisque / #FFE4C4", "CadetBlue / #5F9EA0", "DarkGoldenrod / #B8860B", "FireBrick / #B22222",
      "ForestGreen / #228B22", "HotPink / #FF69B4", "IndianRed / #CD5C5C", "LightSeaGreen / #20B2AA",
      "MediumSpringGreen / #00FA9A", "OliveDrab / #6B8E23", "Peru / #CD853F", "RoyalBlue / #4169E1"
    ];

    let currentRole = "";
    let tg = null;

    // Выбор случайного элемента из массива
    function randomItem(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // Функция скрывает все страницы и показывает нужную
    function showPage(id) {
      document.querySelectorAll(".page").forEach(p => p.style.display = "none");
      const el = document.getElementById(id);
      el.style.display = "flex";
      // Создаём звёзды только для генераторов
      if (id === "design" || id === "marketing") createStars(id);
    }

    function selectRole(role) {
      currentRole = role;
      showPage("loading");
    }

    function goToGenerator() {
      showPage(currentRole);
    }

    function goHome() {
      showPage("home");
    }

    // Генерация ТЗ для дизайнера
    function generateDesign() {
      const c = randomItem(companyNames);
      const p = randomItem(positionings);
      const col = randomItem(colors);
      const prod = randomItem(products);
      const prob = randomItem(designProblems);
      document.getElementById("design-tz").innerHTML = `
        <p class="tz">Компания: ${c}</p>
        <p class="tz">Позиционирование: ${p}</p>
        <p class="tz">Цвет: ${col}</p>
        <p class="tz">Продукт: ${prod}</p>
        <p class="tz">Проблема: ${prob}</p>
      `;
    }

    // Генерация ТЗ для маркетолога
    function generateMarketing() {
      const c = randomItem(companyNames);
      const p = randomItem(positionings);
      const prod = randomItem(products);
      const prob = randomItem(marketingProblems);
      const t = randomItem(tasks);
      const g = randomItem(goals);
      document.getElementById("marketing-tz").innerHTML = `
        <p class="tz">Компания: ${c}</p>
        <p class="tz">Позиционирование: ${p}</p>
        <p class="tz">Продукт: ${prod}</p>
        <p class="tz">Проблема: ${prob}</p>
        <p class="tz">Задача: ${t}</p>
        <p class="tz">Цель: ${g}</p>
      `;
    }

    // Универсальная функция показа алерта через Telegram или стандартный alert
    function showAlert(message) {
      if (tg && typeof tg.showAlert === "function") {
        tg.showAlert(message);
      } else {
        alert(message);
      }
    }

    // Скопировать ТЗ для дизайнера. В Telegram используется tg.showAlert
    function copyDesignTZ() {
      const tz = document.getElementById("design-tz");
      if (!tz.innerText.trim()) return showAlert("Сначала сгенерируйте ТЗ");
      const checks = Array.from(document.querySelectorAll("#design input[type=checkbox]:checked")).map(c => c.value);
      const custom = document.getElementById("custom-design").value.trim();
      const items = [...checks, custom].filter(Boolean).join(", ") || "дизайн";
      const lines = tz.innerText.split("\n").map(l => l.split(": ")[1] || "");
      // lines: [Компания, Позиционирование, Цвет, Продукт, Проблема]
      const text = `Привет! Мы из ${lines[0]}. Занимаемся ${lines[3]}. Столкнулись с проблемой ${lines[4]}.\n` +
                   `Очень нужна помощь! Директор просит сделать тебе ${items}. Учти, что основной цвет — ${lines[2]}, и дизайн должен соответствовать позиционированию: ${lines[1]}.\n` +
                   `Доверяем твоему вкусу, ноль правок. Ждём решение!`;
      // Запись в буфер обмена
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => showAlert("ТЗ скопировано"));
      } else {
        showAlert(text);
      }
    }

    // Скопировать ТЗ для маркетолога
    function copyMarketingTZ() {
      const tz = document.getElementById("marketing-tz");
      if (!tz.innerText.trim()) return showAlert("Сначала сгенерируйте ТЗ");
      const type = document.getElementById("marketing-type").value;
      const lines = tz.innerText.split("\n").map(l => l.split(": ")[1] || "");
      // lines: [Компания, Позиционирование, Продукт, Проблема, Задача, Цель]
      const text = `Привет! Мы из ${lines[0]}. Занимаемся ${lines[2]}. Проблема: ${lines[3]}.\n` +
                   `Нужна твоя помощь! Директор просит решить задачу: ${lines[4]}. Решение должно соответствовать позиционированию (${lines[1]}).\n` +
                   `Цель квартала: ${lines[5]}. Ноль правок. Ждём! (Тип: ${type})`;
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => showAlert("ТЗ скопировано"));
      } else {
        showAlert(text);
      }
    }

    // Очистить ТЗ и чекбоксы
    function clearTZ(role) {
      document.getElementById(role + "-tz").innerHTML = "";
      if (role === "design") {
        document.querySelectorAll("#design input[type=checkbox]").forEach(i => i.checked = false);
        document.getElementById("custom-design").value = "";
      }
    }

    // Создание звёздного фона на генераторных страницах
    function createStars(id) {
      const container = document.querySelector(`#${id} .stars`);
      container.innerHTML = "";
      const count = window.innerWidth > 768 ? 60 : 35;
      for (let i = 0; i < count; i++) {
        const s = document.createElement("div");
        s.className = "star";
        const size = Math.random() * 3 + 1;
        s.style.width = size + "px";
        s.style.height = size + "px";
        s.style.top = Math.random() * 100 + "%";
        s.style.left = Math.random() * 100 + "%";
        s.style.animationDelay = Math.random() * 5 + "s";
        container.appendChild(s);
      }
    }

    // Инициализация страницы
    function init() {
      showPage("home");
      // Проверяем наличие Telegram API
      if (window.Telegram && window.Telegram.WebApp) {
        tg = window.Telegram.WebApp;
        tg.ready();
        // Расширяем приложение, если это Mini App
        if (typeof tg.expand === "function") tg.expand();
        // Получаем тему и применяем к CSS‑переменным
        const theme = tg.themeParams || {};
        if (theme.bg_color) document.documentElement.style.setProperty('--bg-color', theme.bg_color);
        if (theme.text_color) document.documentElement.style.setProperty('--text-color', theme.text_color);
        // Telegram предоставляет цвета кнопок. Используем их, если доступны
        if (theme.button_color && theme.button_color.startsWith('#')) {
          document.documentElement.style.setProperty('--btn-gradient-start', theme.button_color);
          document.documentElement.style.setProperty('--btn-gradient-end', theme.button_color);
        }
        if (theme.button_text_color) document.documentElement.style.setProperty('--btn-text-color', theme.button_text_color);
        // Слушаем изменение темы и обновляем цвета
        tg.onEvent('themeChanged', () => {
          const t = tg.themeParams || {};
          if (t.bg_color) document.documentElement.style.setProperty('--bg-color', t.bg_color);
          if (t.text_color) document.documentElement.style.setProperty('--text-color', t.text_color);
          if (t.button_color) {
            document.documentElement.style.setProperty('--btn-gradient-start', t.button_color);
            document.documentElement.style.setProperty('--btn-gradient-end', t.button_color);
          }
          if (t.button_text_color) document.documentElement.style.setProperty('--btn-text-color', t.button_text_color);
        });
      }
    }

    // Запускаем инициализацию после загрузки DOM
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>